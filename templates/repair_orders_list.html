{% extends "base.html" %}

{% block title %}Repair Orders{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="h3">Repair Orders</h1>
  <a href="{{ url_for('search') }}" class="btn btn-primary">New Repair Order</a>
</div>

{% if repair_orders %}
  <div class="card shadow-sm">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>Ticket #</th>
              <th>Customer</th>
              <th>VIN</th>
              <th>Work Description</th>
              <th>Total</th>
              <th>Status</th>
              <th>Created</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for ticket_number, order in repair_orders.items() %}
            <tr>
              <td><span class="badge bg-primary">{{ order.ticket_number }}</span></td>
              <td>{{ order.customer }}</td>
              <td><code>{{ order.vin }}</code></td>
              <td>{{ order.work_description[:50] }}{% if order.work_description|length > 50 %}...{% endif %}</td>
              <td class="fw-bold">${{ "%.2f"|format(order.total) }}</td>
              <td>
                <span class="badge bg-success">{{ order.status }}</span>
              </td>
              <td>{{ order.created_at[:10] }}</td>
              <td>
                <button class="btn btn-sm btn-outline-primary" onclick="viewOrder('{{ order.ticket_number }}')">
                  View
                </button>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
{% else %}
  <div class="card shadow-sm">
    <div class="card-body text-center py-5">
      <div class="text-muted mb-3">
        <svg width="48" height="48" fill="currentColor" class="bi bi-clipboard-x" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M6.146 7.146a.5.5 0 0 1 .708 0L8 8.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 9l1.147 1.146a.5.5 0 0 1-.708.708L8 9.707l-1.146 1.147a.5.5 0 0 1-.708-.708L7.293 9 6.146 7.854a.5.5 0 0 1 0-.708z"/>
          <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
          <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
        </svg>
      </div>
      <h5>No Repair Orders Yet</h5>
      <p class="text-muted">Create your first repair order to get started.</p>
      <a href="{{ url_for('search') }}" class="btn btn-primary">Create Repair Order</a>
    </div>
  </div>
{% endif %}
{% endblock %}

{% block scripts %}
<script>
  function viewOrder(ticketNumber) {
    // In a real application, this would navigate to a detailed view
    alert(`Viewing repair order #${ticketNumber}\n\nIn a full implementation, this would show detailed order information.`);
  }
</script>
{% endblock %}